<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Quiz Programmation & Sécurité — 49 questions</title>
  <style>
    :root{
      --bg: linear-gradient(180deg,#0f172a 0%, #0b1220 100%);
      --card:#0f172a;
      --glass: rgba(255,255,255,0.04);
      --accent:#6C63FF;
      --accent-2:#00D4FF;
      --muted: #9aa4c0;
      --success: #2dd4bf;
      --danger: #ff6b6b;
      --white: #e6eef8;
    }
    *{box-sizing:border-box}
    body{
      margin:0;font-family:Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: var(--bg); color:var(--white); min-height:100vh; display:flex; align-items:center; justify-content:center;
      padding:28px;
    }
    .wrapper{
      width:100%; max-width:980px; background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));
      border-radius:16px; padding:24px; box-shadow: 0 10px 40px rgba(2,6,23,0.6); border:1px solid rgba(255,255,255,0.03);
      backdrop-filter: blur(6px);
    }
    header{display:flex;align-items:center;gap:16px}
    .logo{
      width:52px;height:52px;border-radius:10px;background:linear-gradient(135deg,var(--accent),var(--accent-2));
      display:flex;align-items:center;justify-content:center;font-weight:800;color:#041124;font-size:18px;
      box-shadow:0 6px 20px rgba(108,99,255,0.18), inset 0 -6px 14px rgba(255,255,255,0.06);
    }
    h1{margin:0;font-size:20px}
    p.lead{margin:6px 0 0;color:var(--muted);font-size:14px}

    main{display:grid;grid-template-columns:1fr 320px; gap:20px; margin-top:18px;}
    /* left card (quiz) */
    .card{
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:12px; padding:18px; border:1px solid rgba(255,255,255,0.03);
    }
    #questionNumber{color:var(--muted);font-size:13px;margin-bottom:8px}
    #questionText{font-size:20px;line-height:1.3;margin-bottom:14px}
    .options{display:flex;flex-direction:column;gap:10px}
    .option{
      background:var(--glass); padding:12px 14px; border-radius:10px; cursor:pointer; color:var(--white);
      border:1px solid rgba(255,255,255,0.03); display:flex;align-items:center;gap:12px;
      transition: transform .12s ease, box-shadow .12s ease, background .12s;
    }
    .option:hover{ transform: translateY(-4px); box-shadow: 0 8px 30px rgba(0,0,0,0.5) }
    .option .letter{ width:36px;height:36px;border-radius:8px;display:flex;align-items:center;justify-content:center;
      font-weight:700;background:rgba(255,255,255,0.03); color:var(--white); border:1px solid rgba(255,255,255,0.02);
    }
    .option.correct{ background: linear-gradient(90deg,#0f8b76,#2ed573); box-shadow:0 10px 30px rgba(46,213,115,0.12); }
    .option.wrong{ background: linear-gradient(90deg,#ff758c,#ff6b6b); box-shadow:0 10px 30px rgba(255,107,107,0.12); }
    .option.dim{ opacity:0.45; }

    .explanation{
      margin-top:14px;padding:12px;border-radius:10px;background: rgba(255,255,255,0.02);
      border-left:4px solid rgba(255,255,255,0.04); color:var(--muted); font-size:14px;
    }

    .controls{display:flex;align-items:center;gap:10px;margin-top:16px}
    .btn{
      background: linear-gradient(90deg,var(--accent),var(--accent-2)); border:none;color:#041124;padding:10px 14px;border-radius:10px;font-weight:700;
      cursor:pointer; box-shadow: 0 8px 26px rgba(108,99,255,0.12);
    }
    .btn.secondary{ background: transparent; border:1px solid rgba(255,255,255,0.06); color:var(--white); padding:8px 12px; font-weight:600 }
    .progress{
      margin-left:auto;color:var(--muted); font-size:13px;
    }

    /* right column (sidebar) */
    .side{
      display:flex;flex-direction:column;gap:12px;
    }
    .card.small{ padding:12px }
    .scoreBig{ font-size:28px; font-weight:800; color:var(--accent-2) }
    .mini{ color:var(--muted); font-size:13px }
    .reviewList{ max-height:380px; overflow:auto; padding-right:6px }
    .reviewItem{ padding:10px;border-radius:8px;background: rgba(255,255,255,0.02); margin-bottom:8px; font-size:13px }
    footer{ margin-top:18px; color:var(--muted); font-size:13px; text-align:center }
    @media (max-width:900px){
      main{ grid-template-columns:1fr; }
      .side{ order:2 }
    }
  </style>
</head>
<body>
  <div class="wrapper" role="application" aria-label="Quiz programmation et sécurité">
    <header>
      <div class="logo">QS</div>
      <div>
        <h1>Quiz Programmation & Sécurité — 49 Q</h1>
        <p class="lead">Une question à la fois · Explication affichée après chaque réponse · Interface moderne</p>
      </div>
    </header>

    <main>
      <section class="card" aria-live="polite">
        <div id="questionNumber">Question <span id="cur">1</span> / <span id="total">49</span></div>
        <div id="questionText">...</div>

        <div class="options" id="options"></div>

        <div id="explanation" class="explanation" style="display:none"></div>

        <div class="controls">
          <button id="nextBtn" class="btn" disabled>Suivant</button>
          <button id="skipBtn" class="btn secondary">Afficher réponse</button>
          <div class="progress" id="progressText">Score: <span id="score">0</span></div>
        </div>
      </section>

      <aside class="side">
        <div class="card small">
          <div class="mini">Statut</div>
          <div style="display:flex;align-items:center;justify-content:space-between;margin-top:8px">
            <div>
              <div class="scoreBig" id="scoreBig">0 / 49</div>
              <div class="mini">Questions répondues : <span id="answered">0</span></div>
            </div>
          </div>
        </div>

        <div class="card small">
          <div class="mini">Relecture des questions incorrectes</div>
          <div class="reviewList" id="reviewList">
            <!-- éléments ajoutés dynamiquement -->
          </div>
        </div>

        <div class="card small">
          <div class="mini">Contrôles</div>
          <div style="margin-top:8px;display:flex;gap:8px">
            <button id="restartBtn" class="btn secondary">Recommencer</button>
            <button id="showAllBtn" class="btn secondary">Afficher toutes corrections</button>
          </div>
        </div>
      </aside>
    </main>

    <footer>Questions et explications basées sur le fichier fourni. Bon courage !</footer>
  </div>

  <script>
    // :::::: Données du quiz (49 questions) ::::::
    // Les textes et les réponses proviennent du fichier que vous avez fourni.
    // Certaines questions (3-14) ont été formulées d'après le contexte et marquées comme "inférées" dans la version initiale.
    const quiz = [
      /*1*/ { q: "Quel est le rôle principal d’un compilateur dans un programme informatique ?",
             opts: ["A) Exécuter le code directement", "B) Traduire le code source en code machine", "C) Déboguer le programme", "D) Charger les bibliothèques dynamiques"],
             a: 1,
             exp: "Un compilateur traduit tout le code source de haut niveau en code machine (un exécutable) avant l'exécution du programme."
      },
      /*2*/ { q: "Quel type de boucle permet d’exécuter une série d’instructions un nombre fixe de fois ?",
             opts: ["A) while", "B) do...while", "C) for", "D) repeat-until"],
             a: 2,
             exp: "La boucle 'for' est utilisée quand le nombre d'itérations est connu à l'avance."
      },
      /*3*/ { q: "Lequel des éléments suivants est un langage de programmation ? (inféré)",
             opts: ["A) HTML", "B) CSS", "C) Java", "D) SQL"],
             a: 2,
             exp: "Java est un langage de programmation. (Question inférée à partir du contexte.)"
      },
      /*4*/ { q: "Que fournit typiquement un IDE (Integrated Development Environment) ? (inféré)",
             opts: ["A) Editeur, débogueur et outils de compilation", "B) Un système d'exploitation", "C) Un serveur web", "D) Un compilateur matériel"],
             a: 0,
             exp: "Un IDE fournit un éditeur de code, un débogueur et des outils de build/compilation."
      },
      /*5*/ { q: "Quelle est la différence principale entre compilation et interprétation ? (inféré)",
             opts: ["A) Le compilateur exécute ligne par ligne", "B) L'interpréteur produit un exécutable", "C) Le compilateur traduit tout avant exécution; l'interpréteur traduit et exécute ligne par ligne", "D) Aucune différence"],
             a: 2,
             exp: "Le compilateur traduit l'ensemble du programme en code machine avant exécution; l'interpréteur traduit et exécute ligne par ligne."
      },
      /*6*/ { q: "Qu'est-ce qu'un type primitif en programmation ? (inféré)",
             opts: ["A) Une bibliothèque", "B) Un type de données de base (int, char, float...)", "C) Un algorithme", "D) Un design pattern"],
             a: 1,
             exp: "Les types primitifs sont des types de données de base comme entier, caractère, flottant..."
      },
      /*7*/ { q: "Quel mot-clé déclare une fonction en JavaScript ? (inféré)",
             opts: ["A) func", "B) function", "C) fn", "D) def"],
             a: 1,
             exp: "En JavaScript on utilise 'function' ou la syntaxe fléchée '() => {}'."
      },
      /*8*/ { q: "Qu'est-ce qu'une erreur de syntaxe ? (inféré)",
             opts: ["A) Erreur d'algorithme", "B) Une faute dans la structure du code empêchant la compilation", "C) Erreur d'exécution", "D) Problème matériel"],
             a: 1,
             exp: "Une erreur de syntaxe est une erreur dans la structure du code qui empêche la compilation ou l'interprétation."
      },
      /*9*/ { q: "Que signifie O(n) en analyse d'algorithmes ? (inféré)",
             opts: ["A) Complexité spatiale", "B) Complexité temporelle linéaire par rapport à n", "C) Nombre d'erreurs", "D) Version du langage"],
             a: 1,
             exp: "O(n) indique une complexité temporelle linéaire en fonction de la taille de l'entrée n."
      },
      /*10*/ { q: "Quel est le rôle d'un interprète (interpreteur) dans un langage de programmation ?",
             opts: ["A) Compiler tout le code d'abord", "B) Traduire et exécuter le code ligne par ligne", "C) Produire un exécutable indépendant", "D) Effectuer uniquement une vérification syntaxique"],
             a: 1,
             exp: "Un interpréteur traduit et exécute le code ligne par ligne, contrairement au compilateur."
      },
      /*11*/ { q: "Qu'est-ce qu'une variable locale ?",
             opts: ["A) Une variable accessible dans tout le programme", "B) Une variable accessible seulement à l'intérieur d'une fonction", "C) Une variable stockée sur disque", "D) Une variable partagée entre processus"],
             a: 1,
             exp: "Une variable locale est déclarée dans une fonction ou un bloc et n'est accessible que là."
      },
      /*12*/ { q: "Quel est l'avantage d'utiliser un tableau dynamique par rapport à un tableau statique ?",
             opts: ["A) La taille peut être modifiée dynamiquement", "B) Meilleure performance constante", "C) Moins d'utilisation mémoire", "D) Plus de sécurité"],
             a: 0,
             exp: "Un tableau dynamique (ArrayList, vector...) peut grandir ou rétrécir en temps d'exécution."
      },
      /*13*/ { q: "Quel est le but principal d'un fichier d'en-tête (.h) en langage C ?",
             opts: ["A) Contenir le code exécutable", "B) Stocker les fichiers binaires", "C) Déclarer des fonctions et des variables externes", "D) Gérer la mémoire"],
             a: 2,
             exp: "Les fichiers d'en-tête déclarent fonctions, prototypes et macros partagés entre fichiers sources."
      },
      /*14*/ { q: "Dans un tri par tas (Heap Sort), quelle structure est principalement utilisée ?",
             opts: ["A) Liste chaînée", "B) Table de hachage", "C) Arbre binaire de recherche", "D) Tas binaire (binary heap)"],
             a: 3,
             exp: "Heap Sort utilise un tas binaire (binary heap) pour gérer les éléments pendant le tri."
      },

      /*15*/ { q: "Qu'est-ce qu'une fonction récursive ?",
             opts: ["A) Une fonction qui boucle indéfiniment", "B) Une fonction qui s'appelle elle-même", "C) Une fonction sans paramètres", "D) Une fonction qui renvoie void"],
             a: 1,
             exp: "Une fonction récursive s'appelle elle-même, avec une condition d'arrêt (cas de base)."
      },
      /*16*/ { q: "La mémoire volatile est :",
             opts: ["A) Mémoire qui ne peut pas être modifiée", "B) Mémoire qui nécessite une alimentation constante pour stocker les données", "C) Mémoire permanente", "D) Mémoire cryptée"],
             a: 1,
             exp: "La mémoire volatile (ex. RAM) perd son contenu lorsque l'alimentation est coupée."
      },
      /*17*/ { q: "Qu'est-ce qu'une fonction lambda en programmation ?",
             opts: ["A) Une fonction définie dans un fichier séparé", "B) Une fonction anonyme définie en ligne", "C) Une fonction pour les matrices", "D) Une fonction de rappel obligatoirement asynchrone"],
             a: 1,
             exp: "Une lambda est une petite fonction anonyme souvent définie en ligne."
      },
      /*18*/ { q: "Quel est le rôle d’un interpréteur dans un langage de programmation ?",
             opts: ["A) Compiler le programme entièrement", "B) Traduire et exécuter le code ligne par ligne", "C) Générer un exécutables indépendant", "D) Analyser uniquement la sémantique"],
             a: 1,
             exp: "Un interpréteur traduit et exécute ligne par ligne (réponse du fichier fourni)."
      },
      /*19*/ { q: "Qu'est-ce qu'une 'variable locale' ?",
             opts: ["A) Accessible globalement", "B) Accessible uniquement à l’intérieur d’une fonction", "C) Stockée dans la base de données", "D) Partagée entre threads sans mutex"],
             a: 1,
             exp: "Une variable locale est accessible uniquement dans la fonction ou le bloc où elle est définie."
      },
      /*20*/ { q: "Quel est l’avantage d’utiliser un tableau dynamique (ex. ArrayList) par rapport à un tableau statique ?",
             opts: ["A) La taille peut être modifiée dynamiquement", "B) Moins de fragmentation", "C) Accès plus rapide par index", "D) Moins de mémoire utilisée"],
             a: 0,
             exp: "Un tableau dynamique peut grandir ou diminuer de taille pendant l'exécution."
      },
      /*21*/ { q: "Quel est le but principal d’un fichier d’en-tête en langage C ?",
             opts: ["A) Contenir le code principal", "B) Stocker les données", "C) Déclarer des fonctions et variables externes (prototypes)", "D) Gérer la compilation"],
             a: 2,
             exp: "Les headers (.h) déclarent prototypes de fonctions, macros, et variables externes."
      },
      /*22*/ { q: "Dans un tri par tas (Heap Sort), quel type de structure de données est principalement utilisé ?",
             opts: ["A) Liste doublement chaînée", "B) Table de hachage", "C) Pile", "D) Tas binaire (Binary Heap)"],
             a: 3,
             exp: "Heap Sort s'appuie sur un tas binaire pour construire et extraire l'ordre."
      },
      /*23*/ { q: "Qu’est-ce qu’une 'fonction récursive' ?",
             opts: ["A) Une fonction récursive ne retourne jamais", "B) Une fonction qui s’appelle elle-même", "C) Une fonction uniquement pour les arbres", "D) Une fonction statique"],
             a: 1,
             exp: "La récursivité consiste à appeler la fonction depuis elle-même jusqu'au cas de base."
      },
      /*24*/ { q: "La mémoire volatile est :",
             opts: ["A) Mémoire permanente", "B) Mémoire qui nécessite une alimentation constante pour stocker des données", "C) Mémoire sauvegardée sur disque", "D) Mémoire chiffrée"],
             a: 1,
             exp: "La RAM est volatile: les données sont perdues sans alimentation."
      },
      /*25*/ { q: "Qu’est-ce qu’une fonction lambda en programmation ?",
             opts: ["A) Une méthode déclarée dans une classe", "B) Une fonction anonyme, définie en ligne", "C) Un pointeur de fonction", "D) Un alias de fonction"],
             a: 1,
             exp: "Une lambda est une fonction anonyme, souvent utilisée pour les callbacks ou expressions courtes."
      },
      /*26*/ { q: "Laquelle des affirmations suivantes est vraie pour un tableau à deux dimensions ?",
             opts: ["A) Il ne peut stocker que des nombres", "B) Il est identique à une liste", "C) Il peut être utilisé pour stocker une matrice", "D) Il est toujours dynamique"],
             a: 2,
             exp: "Un tableau 2D est adapté pour représenter des matrices, grilles ou tables."
      },
      /*27*/ { q: "Un arbre binaire de recherche (BST) permet :",
             opts: ["A) De faire des recherches en complexité logarithmique en moyenne", "B) D'éviter toute recherche", "C) D'indexer uniquement des chaînes", "D) De trier exclusivement des nombres pairs"],
             a: 0,
             exp: "Dans un BST équilibré, les opérations ont en moyenne une complexité O(log n)."
      },
      /*28*/ { q: "Qu’est-ce qu’une condition d’arrêt dans une fonction récursive ?",
             opts: ["A) Un appel récursif supplémentaire", "B) Une instruction d'entrée", "C) Une instruction qui indique quand arrêter de s'appeler (cas de base)", "D) Un timeout système"],
             a: 2,
             exp: "Le cas de base empêche la récursion infinie et évite un débordement de pile."
      },
      /*29*/ { q: "Le tri par sélection (Selection Sort) a une complexité temporelle dans le pire des cas de :",
             opts: ["A) O(n log n)", "B) O(n)", "C) O(n^1.5)", "D) O(n²)"],
             a: 3,
             exp: "Selection Sort a une complexité O(n²) dans tous les cas car il effectue des boucles imbriquées."
      },
      /*30*/ { q: "Un graphe orienté acyclique (DAG) est :",
             opts: ["A) Un graphe sans arêtes", "B) Un graphe non orienté", "C) Un graphe avec des arêtes orientées sans cycles", "D) Un arbre binaire"],
             a: 2,
             exp: "Un DAG a des arêtes dirigées et aucun cycle orienté."
      },
      /*31*/ { q: "Qu'est-ce que la confidentialité en sécurité informatique ?",
             opts: ["A) L'accès réservé uniquement aux utilisateurs autorisés", "B) Le chiffrement des données publiques", "C) La disponibilité des services", "D) La vérification d'intégrité"],
             a: 0,
             exp: "La confidentialité garantit que seules les personnes autorisées peuvent accéder aux informations."
      },
      /*32*/ { q: "Quel type de cryptographie utilise une seule clé pour le chiffrement et le déchiffrement ?",
             opts: ["A) Cryptographie symétrique", "B) Cryptographie asymétrique", "C) Cryptographie quantique", "D) Cryptographie hybride"],
             a: 0,
             exp: "La cryptographie symétrique utilise une clé partagée pour chiffrer et déchiffrer."
      },
      /*33*/ { q: "Lequel des éléments suivants est une méthode d'authentification multifacteur (MFA) ?",
             opts: ["A) Mot de passe seul", "B) Carte à puce + mot de passe", "C) Nom d'utilisateur seul", "D) Question secrète seule"],
             a: 1,
             exp: "MFA combine plusieurs facteurs, par ex. 'quelque chose que vous avez' (carte) + 'quelque chose que vous savez' (mot de passe)."
      },
      /*34*/ { q: "Lequel des éléments suivants est un exemple d'attaque Man-in-the-Middle (MitM) ?",
             opts: ["A) Un attaquant intercepte et modifie les communications entre deux parties", "B) Infection par un virus attaché", "C) Usurpation d'identité locale", "D) Augmentation de privilèges"],
             a: 0,
             exp: "Dans un MitM, l'attaquant intercepte (et parfois modifie) les échanges entre deux entités."
      },
      /*35*/ { q: "Qu'est-ce qu'un pare-feu ?",
             opts: ["A) Un logiciel ou matériel qui filtre le trafic réseau selon des règles", "B) Un dispositif pour accélérer le réseau", "C) Un antivirus", "D) Un composant matériel pour le stockage"],
             a: 0,
             exp: "Un pare-feu surveille et contrôle le trafic réseau en appliquant des règles de sécurité."
      },
      /*36*/ { q: "Quelle est la principale fonction d'un certificat numérique ?",
             opts: ["A) Chiffrer les données", "B) Stocker les mots de passe", "C) Valider l'identité d'une entité ou d'un site", "D) Exécuter des mises à jour"],
             a: 2,
             exp: "Un certificat lie l'identité d'une entité à une clé publique, permettant la vérification d'identité."
      },
      /*37*/ { q: "Quel est le rôle principal d'une signature numérique ?",
             opts: ["A) Chiffrer un document", "B) Garantir l'intégrité et l'authenticité d'un document", "C) Sauvegarder un document sur le cloud", "D) Analyser le contenu"],
             a: 1,
             exp: "Une signature numérique assure que le document n'a pas été modifié et confirme l'identité du signataire."
      },
      /*38*/ { q: "Lequel des éléments suivants est un type de logiciel malveillant (malware) ?",
             opts: ["A) Pare-feu", "B) Logiciel espion (spyware)", "C) Système d'exploitation", "D) Compilateur"],
             a: 1,
             exp: "Le spyware collecte des informations sans le consentement de l'utilisateur; c'est un malware."
      },
      /*39*/ { q: "Qu'est-ce qu'une attaque par déni de service (DoS) ?",
             opts: ["A) Un attaquant empêche les utilisateurs légitimes d'accéder à un service", "B) Voler des données clients", "C) Chiffrer des fichiers et demander une rançon", "D) Injection SQL"],
             a: 0,
             exp: "Le DoS vise à rendre un service indisponible pour ses utilisateurs en le surchargeant."
      },
      /*40*/ { q: "Quelle est la méthode la plus sécurisée pour stocker des mots de passe dans une base de données ?",
             opts: ["A) Stocker en texte clair", "B) Chiffrer avec une clé symétrique sans sel", "C) Hacher avec sel (salt) et un algorithme sûr", "D) Stocker dans un fichier accessible publiquement"],
             a: 2,
             exp: "Le hachage avec sel empêche l'utilisation de rainbow tables et rend le stockage sécurisé."
      },
      /*41*/ { q: "Que signifie le terme 'phishing' ?",
             opts: ["A) Voler des informations en se faisant passer pour une entité de confiance", "B) Attaque physique", "C) Attaque DDoS", "D) Exécution de code sur un serveur distant"],
             a: 0,
             exp: "Le phishing est une attaque d'ingénierie sociale pour tromper des utilisateurs et voler des informations."
      },
      /*42*/ { q: "Quelles sont les différences entre un virus et un ver informatique ?",
             opts: ["A) Le virus infecte d'autres fichiers; le ver se propage sans infecter des fichiers", "B) Le ver nécessite un hôte", "C) Virus = matériel", "D) Il n'y a aucune différence"],
             a: 0,
             exp: "Un virus se fixe à un fichier et se propage via l'exécution; un ver est autonome et se réplique sur le réseau."
      },
      /*43*/ { q: "Quel est l'objectif d'une attaque par force brute ?",
             opts: ["A) Essayer toutes les combinaisons possibles de mots de passe", "B) Casser matériellement un serveur", "C) Voler un certificat", "D) Déchiffrer un algorithme sans clé"],
             a: 0,
             exp: "La force brute consiste à tester de nombreuses combinaisons jusqu'à trouver la bonne."
      },
      /*44*/ { q: "Le chiffrement RSA utilise quelle approche pour sécuriser les données ?",
             opts: ["A) Cryptographie symétrique", "B) Cryptographie asymétrique", "C) Hachage", "D) Stéganographie"],
             a: 1,
             exp: "RSA est un algorithme à clé publique (asymétrique) utilisant une paire clé publique/privée."
      },
      /*45*/ { q: "Un VPN (Virtual Private Network) sert principalement à :",
             opts: ["A) Accélérer la connexion internet", "B) Permettre un accès sécurisé à un réseau via Internet", "C) Remplacer un pare-feu", "D) Sauvegarder les fichiers"],
             a: 1,
             exp: "Un VPN crée un tunnel sécurisé et chiffré entre l'utilisateur et un réseau distant."
      },
      /*46*/ { q: "Que fait un logiciel de détection d'intrusion (IDS) ?",
             opts: ["A) Bloquer automatiquement tout le trafic suspect", "B) Analyser le réseau et signaler des activités suspectes", "C) Chiffrer le trafic", "D) Remplacer un antivirus"],
             a: 1,
             exp: "Un IDS surveille et alerte sur des activités potentiellement malveillantes; contrairement à un IPS, il n'agit pas toujours pour bloquer."
      },
      /*47*/ { q: "Quel est le but du protocole HTTPS ?",
             opts: ["A) Accélérer le HTTP", "B) Chiffrer les communications entre un navigateur et un serveur web", "C) Remplacer DNS", "D) Gérer l'authentification locale"],
             a: 1,
             exp: "HTTPS utilise TLS/SSL pour chiffrer les échanges et protéger contre l'écoute et la falsification."
      },
      /*48*/ { q: "Un ransomware (rançongiciel) est un type de logiciel malveillant qui :",
             opts: ["A) Supprime des fichiers", "B) Crypte les fichiers de la victime et demande une rançon", "C) Surveille le réseau", "D) Répare les fichiers corrompus"],
             a: 1,
             exp: "Le ransomware chiffre les fichiers et demande une rançon pour fournir la clé de déchiffrement."
      },
      /*49*/ { q: "Le 'salting' est une technique utilisée pour :",
             opts: ["A) Rendre la base de données plus rapide", "B) Améliorer la sécurité des mots de passe en ajoutant une valeur aléatoire", "C) Chiffrer les communications", "D) Sauvegarder les mots de passe en clair"],
             a: 1,
             exp: "Le sel (salt) est une valeur aléatoire ajoutée au mot de passe avant hachage pour empêcher les attaques par tables pré-calculées."
      }
    ];

    // :::::: Variables d'état ::::::
    let index = 0;
    let score = 0;
    let answeredCount = 0;
    const incorrects = []; // {index, user, correct}

    // :::::: Références DOM ::::::
    const curEl = document.getElementById('cur');
    const totalEl = document.getElementById('total');
    const qText = document.getElementById('questionText');
    const optionsEl = document.getElementById('options');
    const explanationEl = document.getElementById('explanation');
    const nextBtn = document.getElementById('nextBtn');
    const skipBtn = document.getElementById('skipBtn');
    const scoreEl = document.getElementById('score');
    const scoreBig = document.getElementById('scoreBig');
    const answeredEl = document.getElementById('answered');
    const reviewList = document.getElementById('reviewList');
    const restartBtn = document.getElementById('restartBtn');
    const showAllBtn = document.getElementById('showAllBtn');

    totalEl.textContent = quiz.length;

    // :::::: Fonction pour charger une question ::::::
    function loadQuestion() {
      const item = quiz[index];
      curEl.textContent = index + 1;
      qText.textContent = (index+1) + ". " + item.q;
      optionsEl.innerHTML = "";
      explanationEl.style.display = 'none';
      explanationEl.textContent = "";
      nextBtn.disabled = true;
      skipBtn.disabled = false;

      item.opts.forEach((opt, i) => {
        const div = document.createElement('div');
        div.className = 'option';
        div.setAttribute('role','button');
        div.tabIndex = 0;
        div.innerHTML = `<div class="letter">${String.fromCharCode(65+i)}</div><div class="label">${opt}</div>`;
        div.addEventListener('click', () => selectOption(div, i));
        div.addEventListener('keydown', (e) => { if(e.key === 'Enter') selectOption(div,i) });
        optionsEl.appendChild(div);
      });

      // update sidebar
      scoreEl.textContent = score;
      scoreBig.textContent = `${score} / ${quiz.length}`;
      answeredEl.textContent = answeredCount;
    }

    // :::::: Sélection d'une option ::::::
    function selectOption(div, choice) {
      const item = quiz[index];
      // désactiver autres clics
      Array.from(document.querySelectorAll('.option')).forEach(o => {
        o.style.pointerEvents = 'none';
        o.classList.add('dim');
      });

      div.classList.remove('dim');
      const correctIndex = item.a;

      if (choice === correctIndex) {
        div.classList.add('correct');
        explanationEl.style.display = 'block';
        explanationEl.textContent = "✅ Correct — " + item.exp;
        score++;
      } else {
        div.classList.add('wrong');
        // marquer la bonne réponse
        const optNodes = document.querySelectorAll('.option');
        if (optNodes[correctIndex]) optNodes[correctIndex].classList.add('correct');
        explanationEl.style.display = 'block';
        explanationEl.textContent = "❌ Faux — " + item.exp;
        // stocker pour relecture
        incorrects.push({
          idx: index,
          question: item.q,
          chosen: item.opts[choice],
          correct: item.opts[correctIndex],
          exp: item.exp
        });
      }

      answeredCount++;
      nextBtn.disabled = false;
      skipBtn.disabled = true;

      // mettre à jour score et aside
      scoreEl.textContent = score;
      scoreBig.textContent = `${score} / ${quiz.length}`;
      answeredEl.textContent = answeredCount;

      // mettre à jour liste de revue (affichage minimal)
      renderReviewList();
    }

    // :::::: Afficher réponse (skip) ::::::
    skipBtn.addEventListener('click', () => {
      // simule la sélection de la bonne réponse pour montrer l'explication
      const item = quiz[index];
      const optNodes = document.querySelectorAll('.option');
      optNodes.forEach(o => { o.style.pointerEvents='none'; o.classList.add('dim') });
      const correctIndex = item.a;
      if (optNodes[correctIndex]) optNodes[correctIndex].classList.add('correct');
      explanationEl.style.display = 'block';
      explanationEl.textContent = "ℹ️ Réponse : " + item.opts[item.a] + " — " + item.exp;
      nextBtn.disabled = false;
      skipBtn.disabled = true;
      // Ne compte pas comme répondu / incorrect; n'incrémente pas answeredCount ni score.
    });

    // :::::: Bouton Suivant ::::::
    nextBtn.addEventListener('click', () => {
      if (index < quiz.length - 1) {
        index++;
        loadQuestion();
        window.scrollTo({ top: 0, behavior: 'smooth' });
      } else {
        showResults();
      }
    });

    // :::::: Redémarrer ::::::
    restartBtn.addEventListener('click', () => {
      if (!confirm("Recommencer le quiz depuis le début ?")) return;
      index = 0; score = 0; answeredCount = 0; incorrects.length = 0;
      reviewList.innerHTML = "";
      loadQuestion();
    });

    // :::::: Afficher toutes corrections ::::::
    showAllBtn.addEventListener('click', () => {
      // afficher toutes les questions avec bonne réponse et explication dans une nouvelle fenêtre ou modal simple
      let text = "Corrections — Quiz complet:\\n\\n";
      quiz.forEach((it, i) => {
        text += (i+1) + ". " + it.q + "\\n";
        text += "Réponse correcte: " + it.opts[it.a] + "\\n";
        text += "Explication: " + it.exp + "\\n\\n";
      });
      // ouvrir dans une nouvelle fenêtre (fenêtre texte)
      const w = window.open("", "_blank");
      w.document.write("<pre style='white-space:pre-wrap;font-family:inherit;padding:16px'>" + text.replace(/&/g,'&amp;').replace(/</g,'&lt;') + "</pre>");
    });

    // :::::: Rendu liste de relecture ::::::
    function renderReviewList() {
      reviewList.innerHTML = "";
      if (incorrects.length === 0) {
        reviewList.innerHTML = "<div class='mini' style='color:var(--muted)'>Aucune erreur pour le moment</div>";
        return;
      }
      incorrects.slice().reverse().forEach(ic => {
        const div = document.createElement('div');
        div.className = 'reviewItem';
        div.innerHTML = `<strong>Q:</strong> ${ic.question}<br><strong>Votre choix:</strong> ${ic.chosen}<br><strong>Correct:</strong> ${ic.correct}<br><em style="color:var(--muted);font-size:13px">${ic.exp}</em>`;
        reviewList.appendChild(div);
      });
    }

    // :::::: Résultats finaux ::::::
    function showResults() {
      // construire un résumé complet et l'afficher dans la page principale (remplacer le contenu)
      const wrapper = document.querySelector('.wrapper');
      wrapper.innerHTML = `
        <div style="padding:20px;color:var(--white)">
          <h2 style="margin-top:0">Résultat du quiz</h2>
          <p style="font-size:18px">Score final: <strong style="color:var(--accent-2)">${score} / ${quiz.length}</strong></p>
          <p style="color:var(--muted)">Questions répondues: ${answeredCount} · Erreurs: ${incorrects.length}</p>
          <div style="margin-top:14px;">
            <button id="restartFinal" class="btn">Recommencer</button>
            <button id="downloadBtn" class="btn secondary">Télécharger corrections (.txt)</button>
          </div>
          <h3 style="margin-top:18px">Corrections détaillées</h3>
          <div style="max-height:420px;overflow:auto;padding:10px;border-radius:8px;background:rgba(255,255,255,0.02);margin-top:8px">
            ${quiz.map((it,i)=>`
              <div style="padding:10px;border-bottom:1px solid rgba(255,255,255,0.02);">
                <strong>${i+1}. ${it.q}</strong><br>
                <span style="color:var(--muted)">Réponse correcte:</span> ${it.opts[it.a]}<br>
                <em style="color:var(--muted)">${it.exp}</em>
              </div>
            `).join('')}
          </div>
        </div>
      `;
      document.getElementById('restartFinal').addEventListener('click', () => location.reload());
      document.getElementById('downloadBtn').addEventListener('click', () => {
        const lines = [];
        lines.push("Corrections - Quiz Programmation & Sécurité");
        lines.push("Score: " + score + " / " + quiz.length);
        lines.push("");
        quiz.forEach((it,i) => {
          lines.push((i+1) + ". " + it.q);
          lines.push("Réponse correcte: " + it.opts[it.a]);
          lines.push("Explication: " + it.exp);
          lines.push("");
        });
        const blob = new Blob([lines.join("\\n")], {type: 'text/plain'});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url; a.download = 'corrections_quiz.txt';
        document.body.appendChild(a); a.click();
        a.remove(); URL.revokeObjectURL(url);
      });
    }

    // :::::: Initialisation ::::::
    loadQuestion();
  </script>
</body>
</html>
